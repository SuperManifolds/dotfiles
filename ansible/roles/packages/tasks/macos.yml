---
# Homebrew packages are installed directly in setup.sh (needs TTY for sudo)

# JetBrains Mono Nerd Font
- name: Check if JetBrains Mono Nerd Font is installed
  ansible.builtin.stat:
    path: "{{ ansible_env.HOME }}/Library/Fonts/JetBrainsMonoNerdFont-Regular.ttf"
  register: jetbrains_font
  when: install_desktop | default(true)

- name: Download JetBrains Mono Nerd Font
  ansible.builtin.unarchive:
    src: "https://github.com/ryanoasis/nerd-fonts/releases/latest/download/JetBrainsMono.zip"
    dest: "{{ ansible_env.HOME }}/Library/Fonts"
    remote_src: true
  when:
    - install_desktop | default(true)
    - not jetbrains_font.stat.exists

# Dev tools (via mise)
- name: Install tools via mise
  ansible.builtin.command:
    cmd: mise use -g {{ item }}
  loop:
    - golangci-lint
  changed_when: true

# Install Rust stable toolchain
- name: Install Rust stable toolchain
  ansible.builtin.command:
    cmd: rustup default stable
  changed_when: true

# Install Swift latest
- name: Install Swift latest
  ansible.builtin.command:
    cmd: swiftly install latest
  changed_when: true
